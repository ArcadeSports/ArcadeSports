<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Arcade Sports</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* ===== CSS ARCADE ===== */
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

    body {
      margin: 0;
      /* Nuevo fondo y fuente */
      background: radial-gradient(circle at center, #020202, #000);
      color: #00ff66;
      font-family: 'Press Start 2P', monospace; /* Fuente Arcade */
      overflow: hidden; /* Evita scrollbars innecesarios en modo app */
    }

    /* ===== CONTENEDOR PRINCIPAL ===== */
    #app {
      display: flex;
      height: 100vh;
      /* Borde y glow arcade */
      border: 4px solid #00ff66;
      box-shadow: 0 0 20px #00ff66;
      box-sizing: border-box; /* Para que el borde no rompa el 100vh */
    }

    /* ===== MENU ===== */
    #channelList {
      width: 260px;
      overflow-y: auto;
      /* Estilo Arcade */
      background: linear-gradient(180deg, #020202, #060606);
      border-right: 2px solid #00ff66;
      box-shadow: inset -4px 0 10px rgba(0,255,100,.3);
    }

    /* Scrollbar arcade personalizada (opcional para chrome/webkit) */
    #channelList::-webkit-scrollbar { width: 8px; }
    #channelList::-webkit-scrollbar-thumb { background: #00ff66; }
    #channelList::-webkit-scrollbar-track { background: #000; }

    .channel-item {
      padding: 12px;
      cursor: pointer;
      border-bottom: 1px solid #00441b; /* Borde sutil */
      /* Tipografía Arcade */
      font-size: 11px;
      letter-spacing: 1px;
      text-shadow: 0 0 4px #00ff66;
      transition: all .15s ease;
    }

    .channel-item:hover {
      background: #00ff66;
      color: #000;
      text-shadow: none;
      transform: scale(1.03);
      padding-left: 20px; /* Pequeño desplazamiento visual */
    }

    .channel-item.active {
      background: #00ff66;
      color: #000;
      font-weight: bold;
      box-shadow: inset 0 0 10px rgba(0,0,0,.6), 0 0 12px #00ff66;
    }

    /* ===== PLAYER AREA ===== */
    #playerArea {
      flex: 1;
      position: relative;
      background: #000;
      /* Estilo Arcade */
      border-left: 4px solid #00ff66;
      box-shadow: inset 0 0 25px rgba(0,255,100,.25);
      overflow: hidden;
    }

    /* ===== PANTALLA BIENVENIDA ===== */
    #welcomeScreen {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px; /* Ajustado para fuente pixel */
      z-index: 2;
      /* Efecto parpadeo */
      text-shadow: 0 0 8px #00ff66;
      animation: blink 1.5s infinite;
      text-align: center;
      line-height: 1.5;
    }

    @keyframes blink {
      0%,100% { opacity: 1; }
      50% { opacity: .3; }
    }

    #videoPlayerContainer {
      width: 100%;
      height: 100%;
      display: none;
      position: relative;
      z-index: 1;
    }

    /* ===== VIDEO ===== */
    video {
      width: 100%;
      height: 100%;
      background: black;
      outline: none;
      box-shadow: inset 0 0 40px rgba(0,0,0,.8);
    }

    /* ===== EFECTO GLITCH (CSS) ===== */
    .glitch {
      animation: glitch 0.4s linear;
    }

    @keyframes glitch {
      0% { transform: translate(0); filter: hue-rotate(0deg); }
      20% { transform: translate(-2px, 1px); }
      40% { transform: translate(2px, -1px); }
      60% { transform: translate(-1px, 2px); }
      80% { transform: translate(1px, -2px); }
      100% { transform: translate(0); filter: hue-rotate(360deg); }
    }

    /* ===== EFECTO CRT (SCANLINES) ===== */
    #crt {
      pointer-events: none;
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,0) 0px,
        rgba(0,0,0,0) 2px,
        rgba(0,0,0,0.15) 3px
      );
      mix-blend-mode: overlay;
      animation: crtFlicker 0.15s infinite;
      z-index: 4;
    }

    @keyframes crtFlicker {
      0% { opacity: 0.15; }
      50% { opacity: 0.25; }
      100% { opacity: 0.15; }
    }

    /* ===== OVERLAY ERROR ===== */
    #playerOverlay {
      display: none;
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,.85);
      color: #0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 5;
      text-align: center;
      /* Estilo Arcade */
      font-size: 14px;
      text-shadow: 0 0 10px #00ff66;
    }
  </style>
</head>
<body>

<div id="app">

  <div id="channelList">
    <div class="channel-item" onclick="playChannel('espn1', this)">ESPN</div>
    <div class="channel-item" onclick="playChannel('espn2', this)">ESPN 2</div>
    <div class="channel-item" onclick="playChannel('espn3', this)">ESPN 3</div>
    <div class="channel-item" onclick="playChannel('espn4', this)">ESPN 4</div>
    <div class="channel-item" onclick="playChannel('espn5', this)">ESPN 5</div>
    <div class="channel-item" onclick="playChannel('espn6', this)">ESPN 6</div>
    <div class="channel-item" onclick="playChannel('espn7', this)">ESPN 7</div>
    <div class="channel-item" onclick="playChannel('espnmx', this)">ESPN MX</div>
    <div class="channel-item" onclick="playChannel('winsports', this)">WinSports</div>
    <div class="channel-item" onclick="playChannel('winsports+', this)">WinSports+</div>
    <div class="channel-item" onclick="playChannel('directsports', this)">DirecTV Sports</div>
    <div class="channel-item" onclick="playChannel('tycsports', this)">TyC Sports</div>
    <div class="channel-item" onclick="playChannel('laligahypermotion', this)">LaLiga HyperMotion</div>
    <div class="channel-item" onclick="playChannel('capodeportes', this)">Capo Deportes</div>
  </div>

  <div id="playerArea">
    
    <div id="crt"></div>

    <div id="welcomeScreen">
      INSERT COIN<br><br>
      O SELECCIONA UN CANAL
    </div>

    <div id="videoPlayerContainer">
      <video id="videoPlayer" controls autoplay playsinline muted></video>
    </div>

    <div id="playerOverlay">
      <div>
        <p>GAME OVER (STREAM CAÍDO)</p>
        <p>CONTINUE? (REINTENTANDO…)</p>
      </div>
    </div>

  </div>

</div>

<audio id="beepSound" preload="auto">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.wav" type="audio/wav">
</audio>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
/* ===== CANALES ===== */
const videoUrls = {
  espn1: ["https://florcd1.crackstreamslivehd.com/espn/index.m3u8?token=df487b0bcbfe9a1a3b3b2e6ef1fc6165be80b741-67-1768193218-1768139218&ip=190.106.222.109"],
  espn2: ["https://99a1.crackstreamslivehd.com/espn2/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=0a1cbf7739df157db7b127c2c7fc497a59eae943-b8-1768193842-1768139842"],
  espn3: ["https://24a1.crackstreamslivehd.com/espn3/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=9a1a64ad1595b43092bba0bc7b28a9df1a41a49f-17-1768194011-1768140011"],
  espn4: ["https://99a1.crackstreamslivehd.com/espn4/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=af2f530fa7f3ad16605136f05de72319fc128e0a-8b-1768194045-1768140045"],
  espn5: ["https://pecdl1.crackstreamslivehd.com/espn5/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=b134f7a217fe4423b5660cbf01df2fc2df37aeb9-5d-1768195237-1768141237"],
  espn6: ["https://51a1.crackstreamslivehd.com/espn6/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=4700a29c1a00370ee6a472ecb53f30d302c747a4-37-1768195241-1768141241"],
  espn7: ["https://57b1.crackstreamslivehd.com/espn7/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=e5e425a5ce24423947d8de95f571a22fa126ce7b-af-1768195313-1768141313"],
  espnmx: ["https://57b1.crackstreamslivehd.com/espnmx/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=e41e4e1840c35eba059dcabaac2486187ee2ffb7-63-1768195362-1768141362"],
  winsports: ["https://98ca2.crackstreamslivehd.com/winsports/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=a89eee5a680479bff43622c51b9ba1e6c82ce108-d8-1768195445-1768141445"],
  "winsports+": ["https://pecdl1.crackstreamslivehd.com/winplus/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=2da35cb5a31bdb6e176990643553a316fc99d7a2-77-1768195483-1768141483"],
  directsports: ["https://14c51.crackstreamslivehd.com/dsports/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=580485af03a01450a005af126bb9cc620f1db971-f7-1768195518-1768141518"],
  tycsports: ["https://24a1.crackstreamslivehd.com/tycinternacional/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=384880a4bf97fac9028883afb9aba83d9c7a12c7-f0-1768195611-1768141611"],
  laligahypermotion: ["https://florcd1.crackstreamslivehd.com/laligahypermotion/tracks-v1a1/mono.m3u8?ip=190.106.222.109&token=ea2eba7d908a52563f2bb0d12654be5c8c98233a-16-1768195644-1768141644"],
  capodeportes: ["https://d2.merichunidya.com:1686/hls/capodeportes.m3u8"]
};

/* ===== VARIABLES GLOBALES & UTILIDADES ARCADE ===== */
let hls = null;
let currentChannel = null;
let currentIndex = 0;
let currentMenuIndex = 0; // Para navegación por teclado

const video = document.getElementById("videoPlayer");
const overlay = document.getElementById("playerOverlay");

/* Función de sonido */
function playBeep() {
  const beep = document.getElementById("beepSound");
  if (beep) {
    beep.currentTime = 0;
    beep.volume = 0.4;
    beep.play().catch(()=>{});
  }
}

/* Función Fullscreen */
function toggleFullscreen() {
  const el = document.documentElement;
  if (!document.fullscreenElement) {
    el.requestFullscreen().catch(()=>{});
  } else {
    document.exitFullscreen();
  }
}

/* ===== MOTOR HLS ===== */
function playHLS(url) {
  overlay.style.display = "none";
  
  // EFECTO GLITCH AL CARGAR
  video.classList.remove("glitch");
  void video.offsetWidth; // Trigger reflow
  video.classList.add("glitch");
  setTimeout(() => video.classList.remove("glitch"), 400);

  if (hls) {
    hls.destroy();
    hls = null;
  }

  if (video.canPlayType("application/vnd.apple.mpegurl")) {
    video.src = url;
    video.play();
    return;
  }

  hls = new Hls({ lowLatencyMode: true });
  hls.loadSource(url);
  hls.attachMedia(video);

  hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
  hls.on(Hls.Events.ERROR, (e, data) => {
    if (data.fatal) retryStream();
  });
}

function retryStream() {
  overlay.style.display = "flex";
  const list = videoUrls[currentChannel];
  currentIndex = (currentIndex + 1) % list.length;
  setTimeout(() => playHLS(list[currentIndex]), 3000);
}

/* ===== PLAY CHANNEL ===== */
function playChannel(channelId, el) {
  playBeep(); // Sonido al click

  currentChannel = channelId;
  currentIndex = 0;

  localStorage.setItem("lastChannel", channelId);

  document.getElementById("welcomeScreen").style.display = "none";
  document.getElementById("videoPlayerContainer").style.display = "block";

  const allItems = document.querySelectorAll(".channel-item");
  allItems.forEach(c => c.classList.remove("active"));
  el.classList.add("active");

  // Sincronizar índice del teclado con el click
  currentMenuIndex = Array.from(allItems).indexOf(el);

  playHLS(videoUrls[channelId][0]);
}

/* ===== CONTROL POR TECLADO ===== */
const menuItems = () => [...document.querySelectorAll(".channel-item")];

function highlightMenu(items) {
  // Nota: Solo movemos el foco visual si se desea, 
  // pero mantendremos la clase .active solo en el canal reproduciendo 
  // hasta que se presione ENTER.
  // Para feedback visual inmediato al mover flechas:
  items.forEach(i => i.style.background = ""); // Limpiar estilos inline previos
  items[currentMenuIndex].scrollIntoView({ block: "nearest" });
  
  // Efecto hover simulado
  items.forEach(i => i.classList.remove("active")); // Quitamos active visualmente
  items[currentMenuIndex].classList.add("active"); // Ponemos active temporal
}

document.addEventListener("keydown", e => {
  const items = menuItems();
  if (!items.length) return;

  if (e.key === "ArrowDown") {
    e.preventDefault(); // Evitar scroll de página
    currentMenuIndex = (currentMenuIndex + 1) % items.length;
    highlightMenu(items);
    playBeep();
  }

  if (e.key === "ArrowUp") {
    e.preventDefault();
    currentMenuIndex = (currentMenuIndex - 1 + items.length) % items.length;
    highlightMenu(items);
    playBeep();
  }

  if (e.key === "Enter") {
    // Simula el click en el elemento seleccionado
    items[currentMenuIndex].click();
  }

  if (e.key.toLowerCase() === "f") {
    toggleFullscreen();
  }
});

/* ===== AUTO LOAD ===== */
window.addEventListener("load", () => {
  const last = localStorage.getItem("lastChannel");
  if (last && videoUrls[last]) {
    const el = document.querySelector(`[onclick*="${last}"]`);
    if (el) playChannel(last, el);
  }
});
</script>

</body>
</html>
